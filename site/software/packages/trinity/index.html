<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Trinity - Palmetto Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../../css/theme.css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../../../css/extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Trinity";
    var mkdocs_page_input_path = "software/packages/trinity.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Palmetto Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../about/">About</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../news/">News</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../owner/">Owner</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Basic</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../basic/new/">New Account Request</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../basic/login/">Login</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../basic/started/">Getting Started</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../basic/jupyter/">JupyterLab</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Software</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../software/">Software on Palmetto</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../spack/">User Software Installation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../programming/">Software Development</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Training and Outreach</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../training/schedule/">Training Schedule</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../training/workshop/">Workshop Descriptions</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Misc</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../faq/common/">Common Issues</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../faq/faq/">FAQ</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Palmetto Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
    
    <li>Trinity</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><a href="http://trinityrnaseq.sourceforge.net/">Trinity</a> represents a novel method for the efficient and robust 
de novo reconstruction of transcriptomes from RNA-seq data. Trinity combines three independent software 
modules: Inchworm, Chrysalis, and Butterfly, applied sequentially to process large volumes of RNA-seq 
reads. Trinity partitions the sequence data into many individual de Bruijn graphs, each representing the 
transcriptional complexity at at a given gene or locus, and then processes each graph independently to 
extract full-length splicing isoforms and to tease apart transcripts derived from paralogous genes. </p>
<h2 id="download-trinity">Download Trinity</h2>
<pre><code>wget http://downloads.sourceforge.net/project/trinityrnaseq/trinityrnaseq_r20131110.tgz
tar -zxf trinityrnaseq_r20131110.tgz
cd trinityrnaseq_r20131110
</code></pre>
<h2 id="buildcompile-trinity">Build/compile Trinity</h2>
<p>You can build/compile Trinity by simply running make in the installation directory.  This should build 
Inchworm and Chrysalis, both written in C++.  Butterfly should not require any special compilation, as 
its written in Java and provided as portable precompiled software.</p>
<pre><code>module add gcc/4.8.1
make
</code></pre>
<p>You'll also need to install Bowtie (version 1, not Bowtie2) for running Trinity,</p>
<pre><code>wget http://downloads.sourceforge.net/project/bowtie-bio/bowtie/1.0.0/bowtie-1.0.0-src.zip
unzip bowtie-1.0.0-src.zip
cd bowtie-1.0.0
module add gcc/4.8.1
make
</code></pre>
<p>...and you may also need to install SAMtools,</p>
<pre><code>wget http://downloads.sourceforge.net/project/samtools/samtools/0.1.19/samtools-0.1.19.tar.bz2
tar -jxf samtools-0.1.19.tar.bz2
cd samtools-0.1.19
module add gcc/4.8.1
make
</code></pre>
<h2 id="running-trinity">Running Trinity</h2>
<p>A complete Trinity job runs in a series of stages, so you can run Trinity as a single job or as a 
series of jobs.  The specific settings you choose when running your Trinity job can vary so please 
review the Trinity documentation <a href="http://trinityrnaseq.sourceforge.net/#running_trinity">http://trinityrnaseq.sourceforge.net/#running_trinity</a> to ensure 
that you've chosen the appropriate settings for your job.  The following are just examples for running 
Trinity on Palmetto.  There are a varitey of ways to do this.</p>
<p>For any Trinity job, the number of CPU cores and amount of memory you need will vary depending on 
your job's needs.  Please consult the Trinity documentation to try to determine the appropriate 
hardware for your job.</p>
<p>For a complete, standalone Trinity job, the PBS job script may look something like this:</p>
<p>{% highlight bash %}</p>
<h1 id="binbash">!/bin/bash</h1>
<h1 id="pbs-n-fasta2q">PBS -N fasta2q</h1>
<h1 id="pbs-l-select1ncpus16mpiprocs16mem62gbssdtruewalltime720000">PBS -l select=1:ncpus=16:mpiprocs=16:mem=62gb:ssd=true,walltime=72:00:00</h1>
<h1 id="pbs-j-oe">PBS -j oe</h1>
<p>source /etc/profile.d/modules.sh
module purge
module add gcc/4.8.1</p>
<p>cd $PBS_O_WORKDIR</p>
<p>mkdir -p /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/trinityrnaseq_r20131110 /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/bowtie-1.0.0 /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/samtools-0.1.19 /local_scratch/pbs.${PBS_JOBID}</p>
<p>export PATH=/local_scratch/pbs.${PBS_JOBID}/samtools-0.1.19:$PATH
export PATH=/local_scratch/pbs.${PBS_JOBID}/bowtie-1.0.0:$PATH</p>
<p>cp /home/galen/job1/XXTL.fasta /home/galen/job1/XXTR.fasta /local_scratch/pbs.${PBS_JOBID}
/local_scratch/pbs.${PBS_JOBID}/trinityrnaseq_r20131110/Trinity.pl --seqType fa --JM 60G --left XXTL.fasta --right XXTR.fasta --output /local_scratch/pbs.${PBS_JOBID}/trinity_out_dir --CPU 16 --inchworm_cpu 16 --min_kmer_cov 2</p>
<p>cp -r /local_scratch/pbs.${PBS_JOBID}/trinity_out_dir /home/galen/job1
rm -rf /local_scratch/pbs.${PBS_JOBID}/*
{% endhighlight %}</p>
<p>If you choose to break-up your Trinity stages into separate jobs, those individual stage job 
scripts may look something like these (below).  Note:  the last option for the <code>Trinity.pl</code> 
command in each stage (colored red, below) is how you will instruct Trinity to complete only the 
current stage.  The <code>Trinity.pl</code> script will check to see where the previous job ended and it will 
resume processing tasks from that point.</p>
<p>Trinity <strong>stage 1</strong>, generate the kmer-catalog and run Inchworm,</p>
<p>{% highlight bash %}</p>
<h1 id="binbash_1">!/bin/bash</h1>
<h1 id="pbs-n-tstage1">PBS -N Tstage1</h1>
<h1 id="pbs-l-select1ncpus16mpiprocs16mem62gbssdtruewalltime720000_1">PBS -l select=1:ncpus=16:mpiprocs=16:mem=62gb:ssd=true,walltime=72:00:00</h1>
<h1 id="pbs-j-oe_1">PBS -j oe</h1>
<p>source /etc/profile.d/modules.sh
module purge
module add gcc/4.8.1</p>
<p>cd $PBS_O_WORKDIR</p>
<p>mkdir -p /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/trinityrnaseq_r20131110 /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/bowtie-1.0.0 /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/samtools-0.1.19 /local_scratch/pbs.${PBS_JOBID}</p>
<p>export PATH=/local_scratch/pbs.${PBS_JOBID}/samtools-0.1.19:$PATH
export PATH=/local_scratch/pbs.${PBS_JOBID}/bowtie-1.0.0:$PATH</p>
<p>cp /home/galen/job1/XXTL.fasta /home/galen/job1/XXTR.fasta /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/trinity_out_dir /local_scratch/pbs.${PBS_JOBID}
/local_scratch/pbs.${PBS_JOBID}/trinityrnaseq_r20131110/Trinity.pl --seqType fa --JM 60G --left XXTL.fasta --right XXTR.fasta --output /local_scratch/pbs.${PBS_JOBID}/trinity_out_dir --CPU 16 --inchworm_cpu 16 --min_kmer_cov 2 --no_run_chrysalis</p>
<p>cp -r /local_scratch/pbs.${PBS_JOBID}/trinity_out_dir /home/galen/job1
rm -rf /local_scratch/pbs.${PBS_JOBID}/*
{% endhighlight %}</p>
<p>Trinity <strong>stage 2</strong>, Chrysalis clustering of inchworm contigs and mapping reads,</p>
<p>{% highlight bash %}</p>
<h1 id="binbash_2">!/bin/bash</h1>
<h1 id="pbs-n-tstage2">PBS -N Tstage2</h1>
<h1 id="pbs-l-select1ncpus16mpiprocs16mem62gbssdtruewalltime720000_2">PBS -l select=1:ncpus=16:mpiprocs=16:mem=62gb:ssd=true,walltime=72:00:00</h1>
<h1 id="pbs-j-oe_2">PBS -j oe</h1>
<p>source /etc/profile.d/modules.sh
module purge
module add gcc/4.8.1</p>
<p>cd $PBS_O_WORKDIR</p>
<p>mkdir -p /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/trinityrnaseq_r20131110 /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/bowtie-1.0.0 /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/samtools-0.1.19 /local_scratch/pbs.${PBS_JOBID}</p>
<p>export PATH=/local_scratch/pbs.${PBS_JOBID}/samtools-0.1.19:$PATH
export PATH=/local_scratch/pbs.${PBS_JOBID}/bowtie-1.0.0:$PATH</p>
<p>cp /home/galen/job1/XXTL.fasta /home/galen/job1/XXTR.fasta /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/trinity_out_dir /local_scratch/pbs.${PBS_JOBID}
/local_scratch/pbs.${PBS_JOBID}/trinityrnaseq_r20131110/Trinity.pl --seqType fa --JM 60G --left XXTL.fasta --right XXTR.fasta --output /local_scratch/pbs.${PBS_JOBID}/trinity_out_dir --CPU 16 --inchworm_cpu 16 --min_kmer_cov 2 --no_run_quantifygraph</p>
<p>cp -r /local_scratch/pbs.${PBS_JOBID}/trinity_out_dir /home/galen/job1
rm -rf /local_scratch/pbs.${PBS_JOBID}/*
{% endhighlight %}</p>
<p>Trinity <strong>stage 3</strong>, Chrysalis deBruijn graph construction,</p>
<p>{% highlight bash %}</p>
<h1 id="binbash_3">!/bin/bash</h1>
<h1 id="pbs-n-tstage1_1">PBS -N Tstage1</h1>
<h1 id="pbs-l-select1ncpus16mpiprocs16mem62gbssdtruewalltime720000_3">PBS -l select=1:ncpus=16:mpiprocs=16:mem=62gb:ssd=true,walltime=72:00:00</h1>
<h1 id="pbs-j-oe_3">PBS -j oe</h1>
<p>source /etc/profile.d/modules.sh
module purge
module add gcc/4.8.1</p>
<p>cd $PBS_O_WORKDIR
mkdir -p /local_scratch/pbs.${PBS_JOBID}</p>
<p>cp -r /home/galen/trinityrnaseq_r20131110 /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/bowtie-1.0.0 /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/samtools-0.1.19 /local_scratch/pbs.${PBS_JOBID}</p>
<p>export PATH=/local_scratch/pbs.${PBS_JOBID}/samtools-0.1.19:$PATH
export PATH=/local_scratch/pbs.${PBS_JOBID}/bowtie-1.0.0:$PATH</p>
<p>cp /home/galen/job1/XXTL.fasta /home/galen/job1/XXTR.fasta /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/trinity_out_dir /local_scratch/pbs.${PBS_JOBID}
/local_scratch/pbs.${PBS_JOBID}/trinityrnaseq_r20131110/Trinity.pl --seqType fa --JM 60G --left XXTL.fasta --right XXTR.fasta --output /local_scratch/pbs.${PBS_JOBID}/trinity_out_dir --CPU 16 --inchworm_cpu 16 --min_kmer_cov 2 --no_run_butterfly</p>
<p>cp -r /local_scratch/pbs.${PBS_JOBID}/trinity_out_dir /home/galen/job1
rm -rf /local_scratch/pbs.${PBS_JOBID}/*
{% endhighlight %}</p>
<p>Trinity stage 4, run Butterfly and generate the final Trinity.fasta file,</p>
<p>{% highlight bash %}</p>
<h1 id="binbash_4">!/bin/bash</h1>
<h1 id="pbs-n-tstage1_2">PBS -N Tstage1</h1>
<h1 id="pbs-l-select1ncpus16mpiprocs16mem62gbssdtruewalltime720000_4">PBS -l select=1:ncpus=16:mpiprocs=16:mem=62gb:ssd=true,walltime=72:00:00</h1>
<h1 id="pbs-j-oe_4">PBS -j oe</h1>
<p>source /etc/profile.d/modules.sh
module purge
module add gcc/4.8.1</p>
<p>cd $PBS_O_WORKDIR
mkdir -p /local_scratch/pbs.${PBS_JOBID}</p>
<p>cp -r /home/galen/trinityrnaseq_r20131110 /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/bowtie-1.0.0 /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/samtools-0.1.19 /local_scratch/pbs.${PBS_JOBID}</p>
<p>export PATH=/local_scratch/pbs.${PBS_JOBID}/samtools-0.1.19:$PATH
export PATH=/local_scratch/pbs.${PBS_JOBID}/bowtie-1.0.0:$PATH</p>
<p>cp /home/galen/job1/XXTL.fasta /home/galen/job1/XXTR.fasta /local_scratch/pbs.${PBS_JOBID}
cp -r /home/galen/trinity_out_dir /local_scratch/pbs.${PBS_JOBID}
/local_scratch/pbs.${PBS_JOBID}/trinityrnaseq_r20131110/Trinity.pl --seqType fa --JM 60G --left XXTL.fasta --right XXTR.fasta --output /local_scratch/pbs.${PBS_JOBID}/trinity_out_dir --CPU 16 --inchworm_cpu 16 --min_kmer_cov 2 --bflyHeapSpaceMax 60G --bflyCPU 4</p>
<p>cp -r /local_scratch/pbs.${PBS_JOBID}/trinity_out_dir /home/galen/job1
rm -rf /local_scratch/pbs.${PBS_JOBID}/*
{% endhighlight %}</p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
